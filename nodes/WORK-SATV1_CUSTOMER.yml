fileVersion: 1
id: 5115e60e-0b44-4a56-8af3-f22538f61ca6
name: SATV1_CUSTOMER
operation:
  config:
    postSQL: ""
    preSQL: ""
  database: ""
  deployEnabled: true
  description: Customer data as defined by TPC-H
  isMultisource: false
  locationName: WORK
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22fcece3-1c1a-4c00-9cd1-b595fd008e7c
          stepCounter: 5115e60e-0b44-4a56-8af3-f22538f61ca6
        config:
          is_hk: true
        dataType: STRING
        description: ""
        hashDetails: null
        name: HK_CUSTOMER_H
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2ee87b2-9565-4f5d-afdf-8b3432181c37
                stepCounter: 1454af6b-ae6c-4ce3-985c-4f38c53154e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f013f860-d698-453d-b93b-9d4a0b107ae2
          stepCounter: 5115e60e-0b44-4a56-8af3-f22538f61ca6
        config: {}
        dataType: STRING
        description: ""
        hashDetails: null
        name: HK_CUSTOMER_N_S
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c7be510-8828-46a9-8053-5ad3b9d3283f
                stepCounter: 1454af6b-ae6c-4ce3-985c-4f38c53154e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37335cee-1eba-41d1-a8b7-9d01f3e40bb4
          stepCounter: 5115e60e-0b44-4a56-8af3-f22538f61ca6
        config: {}
        dataType: VARCHAR(25)
        description: ""
        hashDetails: null
        name: C_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eabdc875-ace6-48a5-be4c-740b5f7fcb9d
                stepCounter: 1454af6b-ae6c-4ce3-985c-4f38c53154e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4521b9b2-7644-47cb-9ae9-5c32e89d4f08
          stepCounter: 5115e60e-0b44-4a56-8af3-f22538f61ca6
        config: {}
        dataType: VARCHAR(40)
        description: ""
        hashDetails: null
        name: C_ADDRESS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f72f172d-7a50-4298-8cdb-5ff12ee77532
                stepCounter: 1454af6b-ae6c-4ce3-985c-4f38c53154e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45be6a3b-9596-4958-b296-707be4fd8148
          stepCounter: 5115e60e-0b44-4a56-8af3-f22538f61ca6
        config: {}
        dataType: VARCHAR(15)
        description: ""
        hashDetails: null
        name: C_PHONE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be709f1d-48b5-4055-9879-0eaf3d9b7342
                stepCounter: 1454af6b-ae6c-4ce3-985c-4f38c53154e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95421930-e2b8-4af1-8065-01dbca246bbd
          stepCounter: 5115e60e-0b44-4a56-8af3-f22538f61ca6
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        hashDetails: null
        name: C_ACCTBAL
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e556f65b-bd00-4c37-a7f0-11ec102ccea6
                stepCounter: 1454af6b-ae6c-4ce3-985c-4f38c53154e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe67ca52-74a9-4803-a033-d1fd5d7a546b
          stepCounter: 5115e60e-0b44-4a56-8af3-f22538f61ca6
        config: {}
        dataType: VARCHAR(10)
        description: ""
        hashDetails: null
        name: C_MKTSEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68351386-2f51-458d-9124-f197f9d7c893
                stepCounter: 1454af6b-ae6c-4ce3-985c-4f38c53154e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9889661-d641-442d-8a7d-0df327fd4ab4
          stepCounter: 5115e60e-0b44-4a56-8af3-f22538f61ca6
        config: {}
        dataType: VARCHAR(117)
        description: ""
        hashDetails: null
        name: C_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3759f21e-978e-4103-b679-71d01244bedb
                stepCounter: 1454af6b-ae6c-4ce3-985c-4f38c53154e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89385a97-59eb-4b00-b999-e90401adde8e
          stepCounter: 5115e60e-0b44-4a56-8af3-f22538f61ca6
        config: {}
        dataType: TIMESTAMP
        description: The Load Date Timestamp (LDTS) describes when this data first arrived in the Data Warehouse.
        hashDetails: null
        name: LDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6b0a043-94c8-41fb-b5a5-7c88492c6ae6
                stepCounter: 1454af6b-ae6c-4ce3-985c-4f38c53154e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 549b2a86-7970-40e8-94d5-626624b5d036
          stepCounter: 5115e60e-0b44-4a56-8af3-f22538f61ca6
        config: {}
        dataType: STRING
        description: The Record Source (RSRC) describes the source of this data.
        hashDetails: null
        name: RSRC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19d475b2-5a63-43e0-b168-de6a7f60d2d5
                stepCounter: 1454af6b-ae6c-4ce3-985c-4f38c53154e4
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 1e83e879-83c0-4d42-9e88-2d3a13cd261f
          stepCounter: 5115e60e-0b44-4a56-8af3-f22538f61ca6
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        is_system_ledts: true
        name: LEDTS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              COALESCE(LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
              OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
              ORDER BY "{{ datavault4coalesce.config.ldts_alias }}"), {{ datavault4coalesce__string_to_timestamp(datavault4coalesce.config.timestamp_format, datavault4coalesce.config.end_of_all_times) }})
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 6dd3cb57-e1b8-4087-a6a4-7f16c4661b28
          stepCounter: 5115e60e-0b44-4a56-8af3-f22538f61ca6
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        is_system_current_col: true
        name: IS_CURRENT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE 
                WHEN 
                  LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                  OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                  ORDER BY "{{ datavault4coalesce.config.ldts_alias }}") IS NULL 
                THEN TRUE 
                ELSE FALSE 
              END
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: WORK
            nodeName: SATV0_CUSTOMER
        join:
          joinCondition: FROM {{ ref('WORK', 'SATV0_CUSTOMER') }} "SATV0_CUSTOMER"
        name: SATV1_CUSTOMER
        noLinkRefs: []
  name: SATV1_CUSTOMER
  overrideSQL: false
  schema: ""
  sqlType: data-vault-115:::9
  type: sql
  version: 1
type: Node
